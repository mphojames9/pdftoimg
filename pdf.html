<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PDF → Images (responsive to 280px)</title>

  <style>
    /* ========================
       Responsive, fluid design
       Works down to 280px width
       ======================== */

    :root {
      --bg: #ffffff;
      --muted: #6b7280;
      --panel-border: #e5e7eb;
      --accent: #10b981;
      --accent-2: #06b6d4;
      --text: #111827;
      --shadow: 0 8px 25px rgba(0, 0, 0, 0.06);
      --max-page-width: 1250px;
      --gutter: clamp(6px, 2vw, 20px);
      /* fluid horizontal padding */
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.35;
      font-size: clamp(14px, 2.2vw, 16px);
      padding: 0;
    }

    /* ===== Modern Overlay (Option A) ===== */

.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  backdrop-filter: blur(6px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999999;
  padding: 20px;
}

.overlay-content {
  background: #ffffff;
  width: min(580px, 92%);
  max-height: 85vh;
  overflow-y: auto;
  border-radius: 20px;
  padding: 28px;
  position: relative;
  box-shadow: 0 20px 50px rgba(0,0,0,0.2);
  animation: overlayFadeUp .35s ease forwards;
}

.overlay-close {
  position: fixed;
  top: 14px;
  right: 18px;
  font-size: 28px;
  background: none;
  border: none;
  cursor: pointer;
  font-weight: bold;
  color: #333;
}

.overlay-body {
  margin-top: 12px;
  line-height: 1.55;
  font-size: 15px;
  color: #444;
}

/* Animation */
@keyframes overlayFadeUp {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* Small screens */
@media (max-width: 420px) {
  .overlay-content {
    padding: 20px;
    border-radius: 16px;
  }
  .overlay-close {
    top: 10px;
    right: 12px;
  }
}

    /* ---------- NAV ---------- */
    .nav {
      width: 100%;
      padding: clamp(10px, 2.5vw, 18px) var(--gutter);
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--panel-border);
      gap: 12px;
      position: sticky;
      top: 0;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.98));
      backdrop-filter: blur(3px);
      z-index: 20;
    }

.nav-left {
  display: flex;
  align-items: center;
}

.nav-logo {
  height: clamp(24px, 6vw, 40px);
  width: auto;
  max-width: 140px;
  object-fit: contain;
}


    .nav-right {
      display: flex;
      gap: 14px;
      align-items: center;
    }

    .nav-right a {
      text-decoration: none;
      color: #3b3b3b;
      font-weight: 600;
      font-size: clamp(12px, 2vw, 15px);
    }

    /* ---------- PAGE CONTAINER / HERO ---------- */
    .page {
      max-width: var(--max-page-width);
      margin: 0 auto;
      padding: 24px var(--gutter);
    }

    .hero {
      max-width: 900px;
      width: 100%;
      display: flex;
      gap: clamp(14px, 3vw, 36px);
      align-items: flex-start;
      justify-content: space-between;
      margin-top: 18px;
      flex-wrap: wrap;
      /* key for small screens */
      justify-content: center;
      align-items: center;
    }

    .hero-left {
      flex: 1 1 360px;
      /* grows, but prefers to be at least this */
      min-width: 180px;
    }

    .hero-left h1 {
      margin: 0 0 8px 0;
      font-size: clamp(20px, 6.5vw, 48px);
      line-height: 1.05;
      font-weight: 800;
    }

    .hero-left p {
      margin: 0;
      color: var(--muted);
      font-size: clamp(13px, 3vw, 20px);
    }

    .hero-right {
      /* upload area container */
      flex: 0 0 420px;
      min-width: 220px;
      display: flex;
      justify-content: flex-end;
    }

    /* ---------- UPLOAD CARD ---------- */
    .upload-box {
      width: 100%;
      max-width: 420px;
      background: #fff;
      border-radius: 14px;
      padding: clamp(14px, 3.2vw, 36px);
      box-shadow: var(--shadow);
      border: 1px solid var(--panel-border);
      text-align: left;
      box-sizing: border-box;
      margin: 0 auto;
    }

    /* make upload area a full-width interactive region */
    .upload-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      border: 2px dashed #d1d5db;
      padding: clamp(12px, 2.8vw, 28px);
      border-radius: 12px;
      cursor: pointer;
      width: 100%;
      box-sizing: border-box;
      text-align: center;
      transition: all .15s ease;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.95));
      line-height: 1;
      user-select: none;
    }

    .upload-area:hover {
      border-color: #3b82f6;
      background: #f8fafc;
    }

    .upload-area .title {
      color: #2563eb;
      font-weight: 700;
      font-size: clamp(14px, 2.8vw, 20px);
    }

    .upload-area .sub {
      color: var(--muted);
      font-size: clamp(12px, 2.2vw, 14px);
    }

    .upload-box input[type=file] {
      display: none;
    }

    .options {
      margin-top: 16px;
      font-size: 14px;
      color: #444;
      display: grid;
      gap: 10px;
    }

    .options label {
      font-weight: 600;
      display: block;
      font-size: 13px;
      color: #374151;
    }

    .options select,
    .options input[type="number"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 14px;
      box-sizing: border-box;
    }

    .convert-btn {
      margin-top: 14px;
      width: 100%;
      padding: 12px;
      font-size: 15px;
      font-weight: 800;
      border: none;
      border-radius: 10px;
      background: var(--accent);
      color: white;
      cursor: pointer;
    }

    .convert-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* ---------- PREVIEW GRID ---------- */
    .preview-grid {
      width: 100%;
      margin: 28px 0;
      display: grid;
      gap: 14px;
      /* fluid columns: try to fit many, but degrade smoothly */
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      align-items: start;
      box-sizing: border-box;
    }



    /* Thumb card (vertical) */
    .thumb {
      background: #fff;
      border-radius: 12px;
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      border: 1px solid rgba(15, 23, 42, 0.04);
      min-height: 160px;
    }

    .thumb img,
    .pdf-icon {
      width: 100%;
      height: auto;
      display: block;
      object-fit: contain;
      max-height: 160px;
      background: #f8fafc;
    }

    .meta-row .pdfDetails {
      display: block;
      font-weight: 700;
      font-size: clamp(12px, 1.9vw, 13px);
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 140px;
      width: 90%;
      padding: 4px;
      line-height: 1.1;
    }


    .meta-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 10px;
      flex: 1 1 auto;
    }

    .meta-row small {
      display: block;
      font-weight: 700;
      font-size: 13px;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .download-btn {
      display: inline-block;
      align-self: center;
      width: auto;
      max-width: 100%;
      padding: 10px 14px;
      border-radius: 10px;
      font-weight: 700;
      text-decoration: none;
      text-align: center;
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
      color: #042021;
      box-shadow: 0 6px 18px rgba(16, 185, 129, 0.08);
      transition: transform .14s ease, box-shadow .14s ease, opacity .12s ease;
      white-space: nowrap;
      min-width: 0;
      /* don't force large button */
      box-sizing: border-box;
    }

    .thumb:hover {
      transform: translateY(-6px);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.10);
    }

    .download-btn:hover {
      transform: translateY(-2px);
    }

    /* ---------- FOOTER ---------- */
    .footer {
      width: 100%;
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      padding: var(--gutter);
      box-sizing: border-box;
      flex-wrap: wrap;
      font-size: 14px;
      color: var(--muted);
      position: absolute;
      background-color: rgb(244, 244, 244);
      bottom: 0;
      left: 0;
    }

    .footer .right {
      width: 100%;
      text-align: center;
      letter-spacing: 1px;
    }

    .download-zip {
      padding: 10px 16px;
      border-radius: 10px;
      background: #2563eb;
      color: white;
      font-weight: 700;
      border: none;
      cursor: pointer;
    }

    .download-zip:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* Contact form styles */
.contact-open-btn{background:linear-gradient(90deg,var(--accent-2),var(--accent));color:#042021;padding:10px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
.contact-form {display:grid;gap:12px}
.field{display:flex;flex-direction:column;gap:6px}
.field label{font-weight:700;color:#21313b}
.field input,.field textarea{padding:10px;border-radius:10px;border:1px solid #d1d5db;font-size:14px}
.field textarea{min-height:120px;resize:vertical}
.form-actions{display:flex;gap:10px;justify-content:flex-end;align-items:center}
.btn-primary{background:var(--accent);color:#fff;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:800}
.btn-ghost{background:none;border:1px solid var(--panel-border);padding:8px 12px;border-radius:10px;cursor:pointer}


/* small error box inside overlay */
.form-error{background:#fff3f2;border:1px solid #ffb4b4;color:#9f2a2a;padding:10px;border-radius:8px;margin-bottom:8px;display:none}

    /* ---------- SMALL SCREEN ADJUSTMENTS ---------- */
    @media (max-width: 920px) {
      .hero-right {
        flex: 0 0 360px;
      }
    }

    @media (max-width: 810px) {
      .hero {
        gap: 16px;
      }

      .hero-right {
        justify-content: flex-start;
        flex-basis: 100%;
      }

      .hero-left {
        flex-basis: 100%;
      }

      .preview-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      }

      .hero-left h1 {
        text-align: center;
        padding: 10px;
      }

      .hero-left p {
        text-align: center;
        padding: 5px;
      }

      .upload-area .sub {
        display: none;
      }
    }

    @media (max-width: 450px){
      .overlay {
        padding: 0;
      }
    }

    @media (max-width: 420px) {

      /* stack everything, reduce paddings */
      .nav {
        padding: 10px clamp(10px, 6vw, 16px);
      }

      .page {
        padding: 12px clamp(10px, 6vw, 16px);
      }

      .upload-box {
        padding: clamp(10px, 4vw, 16px);
        border-radius: 12px;
      }

      .options {
        margin-top: 10px;
        gap: 8px;
      }

      .preview-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
      }

      .thumb {
        min-height: 150px;
      }

      .thumb img {
        max-height: 120px;
      }

      .meta-row small {
        font-size: 12px;
        white-space: normal;
      }

      .nav-right a {
        font-size: 12px;
      }

      .hero-left h1 {
        font-size: clamp(18px, 6.5vw, 28px);
      }
    }

    @media (max-width: 370px){
          .overlay-content {
            padding: 5px;
          }

          .overlay-body {
            font-size: 13px;
          }
    }

    @media (max-width: 360px) {
      .preview-grid {
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 8px;
      }

      .thumb img {
        max-height: 100px;
      }

      .meta-row small {
        font-size: 12px;
      }

      .download-btn {
        padding: 9px 12px;
        font-size: 13px;
      }

      .meta-row .pdfDetails {
        /* multiline clamp fallback for small viewports */
        white-space: normal;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        /* show up to 2 lines */
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;

      }
    }

    /* target phones down to 280px wide */
    @media (max-width: 280px) {
      :root {
        --gutter: 8px;
      }

      body {
        font-size: 13px;
      }

      .preview-grid {
        grid-template-columns: 1fr;
        gap: 8px;
      }

      .hero-right {
        padding-top: 4px;
      }

      .thumb img {
        max-height: 88px;
      }

      .meta-row small {
        font-size: 12px;
      }

      .download-btn {
        padding: 8px 10px;
        font-size: 12px;
      }

      .nav-right {
        gap: 8px;
      }

      .nav-right a {
        display: none;
      }

      /* conserve tiny space - keep title only */
      .footer {
        padding-left: 8px;
        padding-right: 8px;
        gap: 8px;
      }

      .hero-left p {
        font-size: 12px;
      }

      .upload-area .title {
        font-size: 14px;
      }
    }

    /* small helper */
    .note {
      color: var(--muted);
      font-weight: 600;
      padding: 12px 0;
    }

    /* ======================
   Toast Notification
   ====================== */
    #toastContainer {
      position: fixed;
      top: 16px;
      right: 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 9999;
      pointer-events: none;
    }

    .toast {
      min-width: 200px;
      max-width: 320px;
      padding: 12px 16px;
      border-radius: 12px;
      background: #10b981;
      /* matches your accent */
      color: #ffffff;
      font-weight: 700;
      font-size: 14px;
      box-shadow: var(--shadow);
      opacity: 0;
      transform: translateY(-10px);
      animation: toast-in 0.35s forwards, toast-out 0.35s 4s forwards;
      pointer-events: auto;
    }

    .toast.error {
      background: #ef4444 !important;
      /* RED */
      color: #fff;
    }


    @keyframes toast-in {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes toast-out {
      from {
        opacity: 1;
        transform: translateY(0);
      }

      to {
        opacity: 0;
        transform: translateY(-10px);
      }
    }

    @media (max-width: 420px) {
      #toastContainer {
        top: 10px;
        right: 0;
      }

      .toast {
        max-width: 90%;
        font-size: 13px;
        border-radius: 10px;
      }
    }
  </style>
</head>

<body>
  <!-- NAV -->
  <div class="nav">
    <div class="nav-left">
  <img src="./images/pdflogo.png" alt="PDF Icon" class="nav-logo">
</div>
    <div class="nav-right" aria-hidden="true">
      <a href="#" onclick="openOverlay()">Privacy T&C's</a>
      <a href="#">Contact</a>
    </div>
  </div>

  <main class="page" id="main">
    <!-- HERO -->
    <section class="hero" aria-labelledby="hero-title">
      <div class="hero-left">
        <h1 id="hero-title">Convert PDF to Images</h1>
        <p>Convert your PDFs to high-quality JPG and PNG images instantly with no size limits or account required. Simply upload, convert, and download your images.</p>
      </div>

      <aside class="hero-right" aria-label="Upload">
        <div class="upload-box" role="region" aria-label="PDF upload region">
          <label class="upload-area" id="dropArea" for="fileInput" tabindex="0" aria-haspopup="listbox">
            <input type="file" id="fileInput" accept="application/pdf" multiple>
            <div class="title">Upload PDF</div>
            <div class="sub">or drop a file</div>
          </label>

          <div class="options" aria-hidden="false">
            <label for="formatSelect">Format
              <select id="formatSelect" name="formatSelect">
                <option value="png">PNG</option>
                <option value="jpeg">JPEG</option>
              </select>
            </label>

            <label style="display: none; " for="scaleSelect">Scale (resolution)
              <select id="scaleSelect" name="scaleSelect">
                <option value="1">100%</option>
                <option value="1.5">150%</option>
                <option value="2">200%</option>
                <option value="3">300%</option>
              </select>
            </label>

            <label for="jpegQuality" style="display: none;">JPEG quality
              <input type="number" id="jpegQuality" name="jpegQuality" min="0.1" max="1" step="0.1" value="1"
                aria-label="JPEG quality" />
            </label>
          </div>

          <button class="convert-btn" id="convertBtn" type="button">Convert</button>
        </div>
      </aside>
    </section>
    <div id="toastContainer"></div>

    <!-- OUTPUT -->
    <div id="output" class="preview-grid" aria-live="polite"></div>

    <button class="download-zip" id="downloadZip" disabled aria-disabled="true">Download ZIP</button>

    <!-- ========= MODERN OVERLAY (OPTION A) ========= -->
<div id="overlay" class="overlay">
  <div class="overlay-content">
    <button class="overlay-close" aria-label="Close overlay">×</button>
    <h2 style="margin-top:0;">Privacy Policy</h2>
    <div class="overlay-body">
      <!-- Your Privacy Policy will be injected here -->
      <p>Loading…</p>
    </div>
  </div>
</div>

<div id="contactOverlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
<div class="overlay-content" role="document">
<button class="overlay-close" data-target="contactOverlay" aria-label="Close overlay">×</button>
<h2 style="margin-top:0;">Contact Us</h2>
<div class="overlay-body">
<div class="form-error" id="contactError"></div>


<form id="contactForm" class="contact-form" novalidate>
<div class="field">
<label for="name">Name</label>
<input id="name" name="name" type="text" required autocomplete="name" />
</div>


<div class="field">
<label for="email">Email</label>
<input id="email" name="email" type="email" required autocomplete="email" />
</div>


<div class="field">
<label for="message">Message</label>
<textarea id="message" name="message" required></textarea>
</div>


<div class="form-actions">
<button type="button" class="btn-ghost" data-target="contactOverlay" id="cancelContact">Cancel</button>
<button type="submit" class="btn-primary" id="sendContact">Send</button>
</div>
</form>


</div>
</div>
</div>


    <!-- FOOTER -->
    <div class="footer" role="contentinfo">
      <div class="right">© 2025 RemoPDF. Crafted for internet users everywhere.</div>
    </div>
  </main>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.min.js"></script>
<!-- EmailJS (client-side) -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

  <script>
    // ------------------------------
    // Minimal, accessible JS (kept as your original)
    // with small robustness tweaks for small screens
    // ------------------------------
    const fileInput = document.getElementById('fileInput');
    const dropArea = document.getElementById('dropArea');
    const convertBtn = document.getElementById('convertBtn');
    const output = document.getElementById('output');
    const downloadZipBtn = document.getElementById('downloadZip');
    const formatSelect = document.getElementById('formatSelect');
    const scaleSelect = document.getElementById('scaleSelect');
    const jpegQualityInput = document.getElementById('jpegQuality');

    convertBtn.disabled = true;
    downloadZipBtn.disabled = true;


    function updateConvertBtnState() {
      convertBtn.disabled = currentFiles.length === 0;
    }

    if (window.pdfjsLib) {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.worker.min.js';
    }

    let currentFiles = [];
    let lastZipBlobUrl = null;

    // drag & drop UX
    ['dragenter', 'dragover'].forEach(evt => {
      dropArea.addEventListener(evt, e => {
        e.preventDefault(); e.stopPropagation();
        dropArea.classList.add('dragover');
      });
    });
    ['dragleave', 'drop'].forEach(evt => {
      dropArea.addEventListener(evt, e => {
        e.preventDefault(); e.stopPropagation();
        dropArea.classList.remove('dragover');
      });
    });
    dropArea.addEventListener('drop', e => {
      const dt = e.dataTransfer;
      if (!dt) return;
      const files = Array.from(dt.files || []).filter(f => f.type === 'application/pdf' || f.name.toLowerCase().endsWith('.pdf'));
      if (files.length) handleFiles(files);
    });
    // click/keyboard to open file picker
    dropArea.addEventListener('click', () => fileInput.click());
    dropArea.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); fileInput.click(); }
    });
    fileInput.addEventListener('change', e => handleFiles(Array.from(e.target.files || [])));

    function handleFiles(files) {
      const seen = new Map(currentFiles.map(f => [f.name + '_' + f.size, true]));
      files.forEach(f => {
        if (!seen.has(f.name + '_' + f.size)) {
          currentFiles.push(f);
          seen.set(f.name + '_' + f.size, true);
        }
      });

      renderFileListSummary();
      updateConvertBtnState(); // <— NEW LINE
    }


    function renderFileListSummary() {
      output.innerHTML = '';
      if (!currentFiles.length) {
        output.innerHTML = '<div class="note">No files selected yet.</div>';
        updateConvertBtnState(); // <— NEW LINE
        return;
      }
      currentFiles.forEach((f) => {
        const el = document.createElement('div');
        el.className = 'thumb card';
        el.style.padding = '12px';
        el.style.display = 'flex';
        el.style.alignItems = 'center';
        el.style.gap = '12px';

        el.innerHTML = `
         <!-- X REMOVE BUTTON -->
  <button class="remove-file-btn" style="
      position: absolute;
      top: 6px;
      right: 6px;
      background: #ff4d4d;
      color: white;
      border: none;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
  ">×</button>
      <img src="./images/pdfIcon.jpg" class="pdf-icon" alt="PDF">
      <div class='meta-row'>
         <div class='pdfDetails'>${escapeHtml(f.name)}</div>
         <small style="font-weight: 500; padding:0 10px;">${(f.size / 1024 / 1024).toFixed(2)} MB</small>
      </div>
    `;

        output.appendChild(el);

        // attach remove button listener
const removeBtn = el.querySelector('.remove-file-btn');

removeBtn.addEventListener('click', () => {
    // remove the file using its index
    const idx = currentFiles.indexOf(f);
    if (idx > -1) currentFiles.splice(idx, 1);

    // re-render UI
    renderFileListSummary();
    updateConvertBtnState();
});

      });


      updateConvertBtnState(); // <— NEW LINE
    }



    function escapeHtml(s) { return String(s).replace(/[&<>"']/g, c => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", "\"": "&quot;", "'": "&#39;" }[c])); }

    // conversion pipeline (same core logic, with small memory-friendly tweaks)
    convertBtn.addEventListener('click', async () => {
      if (!currentFiles.length) return alert('Please add one or more PDF files first.');
      convertBtn.disabled = true; convertBtn.textContent = 'Converting...';
      output.innerHTML = '';
      if (lastZipBlobUrl) { try { URL.revokeObjectURL(lastZipBlobUrl); } catch (e) { } lastZipBlobUrl = null; }

      const zip = new JSZip();
      const format = formatSelect.value;
      const scale = Number(scaleSelect.value) || 1;
      const jpegQuality = Number(jpegQualityInput.value) || 0.92;

      for (let i = 0; i < currentFiles.length; i++) {
        const file = currentFiles[i];
        let arrayBuffer;
        try {
          arrayBuffer = await file.arrayBuffer();
        } catch (err) {
          console.error('file read error', err);
          const errEl = document.createElement('div'); errEl.className = 'thumb card'; errEl.innerHTML = `<div style="font-weight:700">${escapeHtml(file.name)}</div><small style="color:#ff6b6b">Failed to read file</small>`; output.appendChild(errEl);
          continue;
        }

        const loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
        let pdf = null;
        try {
          pdf = await loadingTask.promise;
        } catch (err) {
          console.error('Error loading PDF', file.name, err);
          const errEl = document.createElement('div'); errEl.className = 'thumb card'; errEl.innerHTML = `<div style="font-weight:700">${escapeHtml(file.name)}</div><small style="color:#ff6b6b">Failed to open PDF</small>`; output.appendChild(errEl);
          continue;
        }

        for (let p = 1; p <= pdf.numPages; p++) {
          const page = await pdf.getPage(p);
          const viewport = page.getViewport({ scale: 1 });
          const canvas = document.createElement('canvas');
          const context = canvas.getContext('2d');

          // safe integer sizes
          canvas.width = Math.max(1, Math.floor(viewport.width * scale));
          canvas.height = Math.max(1, Math.floor(viewport.height * scale));

          const renderContext = { canvasContext: context, viewport: page.getViewport({ scale }) };
          await page.render(renderContext).promise;

          // Enable ZIP button only after successful conversion
          downloadZipBtn.disabled = false;
          downloadZipBtn.removeAttribute('aria-disabled');

          const blob = await new Promise(res => canvas.toBlob(res, format === 'jpeg' ? 'image/jpeg' : 'image/png', jpegQuality));

          const baseName = file.name.replace(/\.pdf$/i, '');
          const pageName = `${baseName}_page_${String(p).padStart(3, '0')}.${format === 'jpeg' ? 'jpg' : 'png'}`;
          zip.file(pageName, blob);

          // show thumbnail
          const thumb = document.createElement('div'); thumb.className = 'thumb';
          const url = URL.createObjectURL(blob);
          thumb.innerHTML = `
            <img alt="${escapeHtml(pageName)}" src="${url}" />
            <div class="meta-row">
              <small title="${escapeHtml(pageName)}">${escapeHtml(pageName)}</small>
              <a class="download-btn" download="${escapeHtml(pageName)}" href="${url}">Download</a>
            </div>
          `;
          output.appendChild(thumb);
        }

        try { pdf.cleanup && pdf.cleanup(); pdf.destroy && pdf.destroy(); } catch (e) { }
      }

      convertBtn.textContent = 'Finalizing ZIP...';
      try {
        const zipBlob = await zip.generateAsync({ type: 'blob' });
        lastZipBlobUrl = URL.createObjectURL(zipBlob);
        downloadZipBtn.href = lastZipBlobUrl;
        downloadZipBtn.download = `pdf-images-${Date.now()}.zip`;
        downloadZipBtn.disabled = false;
        downloadZipBtn.removeAttribute('aria-disabled');
        showToast(`Success! Converted ${currentFiles.length} file(s) with a total of ${Array.from(output.querySelectorAll('.thumb')).length} page(s).`);
        const blob = await zip.generateAsync({ type: 'blob' });
        lastZipBlobUrl = URL.createObjectURL(blob);
        downloadZipBtn.disabled = false;
        downloadZipBtn.removeAttribute('aria-disabled');

      } catch (e) {
        console.error('zip error', e);
        showToast('Failed to create ZIP file.');
      } finally {
        convertBtn.disabled = false;
        convertBtn.textContent = 'Convert';
      }
    });

    downloadZipBtn.addEventListener('click', (e) => {
      if (downloadZipBtn.disabled) { e.preventDefault(); return; }
      const a = document.createElement('a'); a.href = downloadZipBtn.href; a.download = downloadZipBtn.download || 'pdf-images.zip'; document.body.appendChild(a); a.click(); a.remove();
    });

    function showToast(message, type = "success") {
      const container = document.getElementById("toastContainer");

      const toast = document.createElement("div");
      toast.className = "toast";

      // apply red background for error
      if (type === "error") {
        toast.classList.add("error");
      }

      toast.textContent = message;

      container.appendChild(toast);

      // remove after animation
      setTimeout(() => {
        toast.remove();
      }, 7000);
    }

    // ===== Modern Overlay (Option A) =====

const overlay = document.getElementById("overlay");
const overlayClose = document.querySelector(".overlay-close");
const overlayBody = document.querySelector(".overlay-body");

function openOverlay() {
  overlay.style.display = "flex";

  overlayBody.innerHTML = `

    <h3>1. Introduction</h3>
    <p>RemoPDF ("we", "our", "the website") is committed to protecting your privacy.
    This Privacy Policy explains how we handle information when you use our free
    PDF-to-Image conversion tool. By accessing or using the RemoPDF website, 
    you agree to these Terms & Conditions. If you do not agree, please stop using the site immediately.</p>

    <h3>2. No File Uploads — Local Processing Only</h3>
    <p>RemoPDF is designed so that all PDF conversion happens locally on your device using browser technologies (JavaScript, PDF.js).</p>
    <ul>
      <li>Your PDF files NEVER leave your device.</li>
      <li>We do not upload, store, analyze, or access your files in any way.</li>
      <li>No PDFs or converted images are sent to our servers because the processing uses client-side rendering.</li>
      <li>Your files belong entirely to you.</li>
    </ul>

    <h3>3. Information We Do NOT Collect</h3>
    <p>RemoPDF does <strong>NOT</strong> collect or store:</p>
    <ul>
      <li>Personal information</li>
      <li>Email addresses</li>
      <li>Names or contact details</li>
      <li>Uploaded files or images</li>
      <li>IP addresses</li>
      <li>User account data (no account required)</li>
      <li>Payment information</li>
      <li>Conversion history</li>
      <li>Cookies for tracking or analytics</li>
    </ul>
    <p>We do not sell, share, or trade user data with any third party.</p>

    <h3>4. Information We MAY Collect</h3>
    <p>To maintain the site and improve performance, we may use standard, privacy-friendly web hosting logs which can include:</p>
    <ul>
      <li>Browser type</li>
      <li>Device type</li>
      <li>Basic usage statistics (anonymous)</li>
      <li>Error logs when the site fails to load</li>
    </ul>
    <p>These logs:</p>
    <ul>
      <li>Do not identify you personally</li>
      <li>Are used solely for performance monitoring</li>
      <li>Are deleted regularly as part of hosting operations</li>
    </ul>
    <p>We do NOT use Google Analytics or other intrusive trackers unless explicitly stated.</p>

    <h3>5. Cookies</h3>
    <p>RemoPDF does not use cookies for tracking, advertising, or analytics.</p>
    <p>If any cookies appear, they are strictly:</p>
    <ul>
      <li>Temporary</li>
      <li>Functional</li>
      <li>Required for the website to operate</li>
    </ul>

    <h3>6. Third-Party Services</h3>
    <p>RemoPDF uses the following open-source libraries:</p>
    <ul>
      <li><strong>PDF.js</strong> — for rendering PDF pages</li>
      <li><strong>JSZip</strong> — for ZIP creation</li>
    </ul>
    <p>These libraries run entirely in your browser and do not transmit your data externally.</p>
    <p>If you click external links (e.g., ads, social media, support email), those sites have their own privacy policies.</p>

    <h3>7. Data Security</h3>
    <p>Because your files never leave your browser:</p>
    <ul>
      <li>There is no risk of your PDF being intercepted or stored by RemoPDF</li>
      <li>You retain full control over your files at all times</li>
    </ul>
    <p>However, you should always ensure:</p>
    <ul>
      <li>Your device is secure</li>
      <li>Your browser is up to date</li>
      <li>You trust the network you are using</li>
    </ul>

    <h3>8. Children’s Privacy</h3>
    <p>RemoPDF is safe for all ages and does not collect personal information.
    However, minors should always use the internet responsibly.</p>

    <h3>9. Changes to This Policy</h3>
    <p>We may update this Privacy Policy over time.
    By continuing to use the site, you agree to the most recent version.</p>

    <h3>10. Contact Us</h3>
    <p>If you have any questions or concerns:</p>
    <p><strong>Email:</strongtmsoftwaresprivacy@outlook.com</p>
  `;
}


overlayClose.onclick = () => overlay.style.display = "none";

overlay.addEventListener("click", (e) => {
  if (e.target === overlay) overlay.style.display = "none"; // click outside to close
});


const EMAILJS_SERVICE_ID = 'service_a7c5ag9';
const EMAILJS_TEMPLATE_ID = 'template_5bc1mt5';
const EMAILJS_PUBLIC_KEY = 'drD2CBWiRuBzQGBEO';

// Initialize EmailJS
if (window.emailjs) {
  emailjs.init(EMAILJS_PUBLIC_KEY);
} else {
  console.warn('EmailJS not loaded; contact form will not send emails.');
}

/* ---------- UI references ---------- */
const contactOverlay = document.getElementById('contactOverlay');
const contactForm = document.getElementById('contactForm');
const contactError = document.getElementById('contactError');
const sendContactBtn = document.getElementById('sendContact');
const cancelContactBtn = document.getElementById('cancelContact');
const overlayCloseButtons = document.querySelectorAll('.overlay-close[data-target="contactOverlay"], .overlay-close');
const navContactLink = document.querySelector('.nav-right a[href="#"]');
const toastContainer = document.getElementById('toastContainer');

function showToast(message, type = 'success') {
  const container = toastContainer || document.getElementById('toastContainer') || document.body;
  const toast = document.createElement('div');
  toast.className = 'toast' + (type === 'error' ? ' error' : '');
  toast.textContent = message;
  // pointer events allowed on toasts only
  if (!toastContainer) {
    toast.style.position = 'fixed';
    toast.style.top = '16px';
    toast.style.right = '16px';
    toast.style.zIndex = '99999';
  }
  container.appendChild(toast);
  setTimeout(() => toast.remove(), 7000);
}

function setContactError(message) {
  if (!contactError) return;
  if (!message) {
    contactError.style.display = 'none';
    contactError.textContent = '';
    return;
  }
  contactError.style.display = 'block';
  contactError.textContent = message;
  // ensure error is visible to screen readers
  contactError.setAttribute('role', 'alert');
}

/* Overlay open/close with focus management */
function openContactOverlay() {
  contactOverlay.style.display = 'flex';
  contactOverlay.setAttribute('aria-hidden', 'false');
  // focus first input
  const firstInput = contactOverlay.querySelector('input, textarea, button');
  if (firstInput) firstInput.focus();
  // clear previous error
  setContactError('');
}

function closeContactOverlay() {
  contactOverlay.style.display = 'none';
  contactOverlay.setAttribute('aria-hidden', 'true');
  // return focus to contact button (if exists)
  const contactBtn = document.querySelector('.contact-open-btn') || document.querySelector('.nav-right a[href="#"]');
  if (contactBtn) contactBtn.focus();
}

/* hook the nav "Contact" link to open overlay) */
const contactLinks = Array.from(document.querySelectorAll('.nav-right a')).filter(a => /contact/i.test(a.textContent));
if (contactLinks.length) {
  contactLinks.forEach(a => {
    a.addEventListener('click', (ev) => {
      ev.preventDefault();
      openContactOverlay();
    });
  });
}

/* close handlers (X and cancel) */
cancelContactBtn.addEventListener('click', (e) => {
  e.preventDefault();
  setContactError('');
  closeContactOverlay();
});

contactOverlay.addEventListener('click', (e) => {
  // if clicking on backdrop itself, close overlay
  if (e.target === contactOverlay) {
    setContactError('');
    closeContactOverlay();
  }
});

// close X buttons specifically targeting this overlay
Array.from(document.querySelectorAll('.overlay-close')).forEach(btn => {
  btn.addEventListener('click', (ev) => {
    const target = btn.getAttribute('data-target') || '';
    if (!target || target === 'contactOverlay') {
      setContactError('');
      if (contactOverlay.style.display === 'flex') closeContactOverlay();
      else {
        const mainOverlay = document.getElementById('overlay');
        if (mainOverlay) mainOverlay.style.display = 'none';
      }
    }
  });
});

function validateContactForm() {
  const name = contactForm.name.value.trim();
  const email = contactForm.email.value.trim();
  const message = contactForm.message.value.trim();

  if (!name) return 'Please enter your name.';

  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!email || !emailRegex.test(email)) return 'Please enter a valid email address.';
  if (!message || message.length < 6) return 'Message must be at least 6 characters.';
  return null;
}

/* ---------- Submitting the form with EmailJS ---------- */
contactForm.addEventListener('submit', (e) => {
  e.preventDefault();
  setContactError('');
  const validationError = validateContactForm();
  if (validationError) {
    setContactError(validationError);
    return;
  }

  // disable send button while sending
  sendContactBtn.disabled = true;
  sendContactBtn.textContent = 'Sending...';

  // build template params expected by your EmailJS template
  const templateParams = {
    from_name: contactForm.name.value.trim(),
    from_email: contactForm.email.value.trim(),
    message: contactForm.message.value.trim(),
    // add more fields if your template expects them
  };

  // If EmailJS isn't loaded, fail gracefully
  if (!window.emailjs || !emailjs.send) {
    setContactError('Email service unavailable. Please try again later.');
    sendContactBtn.disabled = false;
    sendContactBtn.textContent = 'Send';
    return;
  }

  // send via EmailJS
  emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams)
    .then((response) => {
      // success: close overlay, show toast, reset form
      closeContactOverlay();
      contactForm.reset();
      showToast('Message sent. Thanks!', 'success');
    })
    .catch((err) => {
      // failure: keep overlay open, show inline error and toast
      console.error('EmailJS send error:', err);
      setContactError('Failed to send message. Please try again or email us directly.');
      showToast('Failed to send message.', 'error');
    })
    .finally(() => {
      sendContactBtn.disabled = false;
      sendContactBtn.textContent = 'Send';
    });
});

/* ---------- Accessibility: trap focus inside overlay while open (simple) ---------- */
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    // close contact overlay on Escape
    if (contactOverlay.style.display === 'flex') {
      setContactError('');
      closeContactOverlay();
    }
    // also hide the privacy overlay (existing)
    const mainOverlay = document.getElementById('overlay');
    if (mainOverlay && mainOverlay.style.display === 'flex') mainOverlay.style.display = 'none';
  }
});

/* ---------- Ensure the contact overlay is hidden by default ---------- */
contactOverlay.style.display = 'none';
contactOverlay.setAttribute('aria-hidden', 'true');
setContactError('');


    // initial UI
    renderFileListSummary();
  </script>
</body>

</html>